angular.module("bgradarApp.controllers",[]).controller("WallController",["$scope","$modal","BGlbs",function($scope,$modal,BGlbs){var init=function(){$scope.selectedRecord={};BGlbs.list(function(data){$scope.records=data.results})};init(),$scope.showModal=function(selectedRecord){$("#myModal").modal(),$scope.website=selectedRecord.fans_url,$scope.comment=selectedRecord.comment,$scope.selectedRecord=selectedRecord},$scope.save=function(){var patchData={_id:$scope.selectedRecord.uid,comment:$scope.comment||"",fans_url:$scope.website||""};BGlbs.updateData(patchData,function(){alert("感謝眾鄉民的工人智慧！"),$("#myModal").modal("toggle"),$scope.website="",$scope.comment="",init()})}}]).controller("RadarController",["$scope","BGlbs",function($scope,BGlbs){var init=function(){BGlbs.list(function(data){$scope.markers=[],console.log(data),_.each(data.results,function(marker){var obj={id:marker.uid,latitude:marker.lat,longitude:marker.lng,title:"Test Record",showWindow:!1};obj.closeClick=function(){},obj.onClicked=function(){$scope.onMarkerClicked(marker)},$scope.markers.push(obj)})});var markers=[{id:1,latitude:45,longitude:-74,showWindow:!1,title:"Marker 2"},{id:2,latitude:15,longitude:30,showWindow:!1,title:"Marker 2"},{id:3,latitude:37,longitude:-122,showWindow:!1,title:"Plane"},{id:4,latitude:37,longitude:-122,showWindow:!1,title:"Plane"}];$scope.map={center:{latitude:45,longitude:-73},zoom:14,markers:markers}};$scope.onMarkerClicked=function(marker){markerToClose=marker,marker.showWindow=!0,$scope.$apply()},init()}]);